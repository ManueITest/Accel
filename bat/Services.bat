@echo off

::admin check
>nul 2>&1 "%SYSTEMROOT%\system32\cacls.exe" "%SYSTEMROOT%\system32\config\system"
    if '%errorlevel%' NEQ '0' (
    goto uacprompt
    ) else ( goto gotadmin )
    :uacprompt
    echo Set UAC = CreateObject^("Shell.Application"^) > "%temp%\getadmin.vbs"
    echo UAC.ShellExecute "%~s0", "", "", "runas", 1 >> "%temp%\getadmin.vbs"
    "%temp%\getadmin.vbs"
    exit /B
    :gotadmin
    if exist "%temp%\getadmin.vbs" ( del "%temp%\getadmin.vbs" )
    pushd "%CD%"
    CD /D "%~dp0"
	
::lower services
sc config "ALG" start= demand
sc config "AppIDSvc" start= demand
sc config "Appinfo" start= demand
sc config "AppReadiness" start= demand
sc config "AppXSvc" start= demand
sc config "ApxSvc" start= demand
sc config "AudioEndpointBuilder" start= auto
sc config "Audiosrv" start= auto
sc config "autotimesvc" start= demand
sc config "AxInstSV" start= demand
sc config "BDESVC" start= disabled
sc config "BFE" start= auto
sc config "BITS" start= demand
sc config "BrokerInfrastructure" start= auto
sc config "BTAGService" start= demand
sc config "BthAvctpSvc" start= demand
sc config "bthserv" start= demand
sc config "camsvc" start= demand
sc config "CDPSvc" start= auto
sc config "CertPropSvc" start= demand
sc config "ClipSVC" start= demand
sc config "COMSysApp" start= demand
sc config "CoreMessagingRegistrar" start= auto
sc config "CryptSvc" start= auto
sc config "DcomLaunch" start= auto
sc config "dcsvc" start= demand
sc config "defragsvc" start= demand
sc config "DeviceAssociationService" start= demand
sc config "DeviceInstall" start= demand
sc config "DevQueryBroker" start= demand
sc config "Dhcp" start= auto
sc config "diagsvc" start= demand
sc config "DiagTrack" start= disabled
sc config "DispBrokerDesktopSvc" start= auto
sc config "DisplayEnhancementService" start= demand
sc config "DmEnrollmentSvc" start= demand
sc config "dmwappushservice" start= demand
sc config "Dnscache" start= auto
sc config "DoSvc" start= demand
sc config "dot3svc" start= demand
sc config "DPS" start= demand
sc config "DsmSvc" start= demand
sc config "DsSvc" start= demand
sc config "DusmSvc" start= auto
sc config "EapHost" start= demand
sc config "EFS" start= demand
sc config "embeddedmode" start= demand
sc config "EntAppSvc" start= demand
sc config "EventLog" start= auto
sc config "EventSystem" start= auto
sc config "fdPHost" start= demand
sc config "FDResPub" start= demand
sc config "fhsvc" start= demand
sc config "FontCache" start= disabled
sc config "FrameServer" start= demand
sc config "FrameServerMonitor" start= demand
sc config "GameInputSvc" start= demand
sc config "gpsvc" start= auto
sc config "GraphicsPerfSvc" start= demand
sc config "hidserv" start= demand
sc config "HvHost" start= demand
sc config "icssvc" start= demand
sc config "IKEEXT" start= demand
sc config "InstallService" start= demand
sc config "InventorySvc" start= auto
sc config "iphlpsvc" start= auto
sc config "IpxlatCfgSvc" start= demand
sc config "KeyIso" start= demand
sc config "KtmRm" start= demand
sc config "LanmanServer" start= demand
sc config "LanmanWorkstation" start= auto
sc config "lfsvc" start= disabled
sc config "LicenseManager" start= demand
sc config "lltdsvc" start= demand
sc config "lmhosts" start= demand
sc config "LocalKdc" start= auto
sc config "LSM" start= auto
sc config "LxpSvc" start= demand
sc config "MapsBroker" start= demand
sc config "McpManagementService" start= demand
sc config "mpssvc" start= auto
sc config "MSDTC" start= demand
sc config "MSiSCSI" start= demand
sc config "msiserver" start= demand
sc config "NaturalAuthentication" start= demand
sc config "NcaSvc" start= demand
sc config "NcbService" start= demand
sc config "NcdAutoSetup" start= demand
sc config "Netlogon" start= demand
sc config "Netman" start= demand
sc config "netprofm" start= demand
sc config "NetSetupSvc" start= demand
sc config "NetTcpPortSharing" start= disabled
sc config "NgcCtnrSvc" start= demand
sc config "NgcSvc" start= demand
sc config "NlaSvc" start= demand
sc config "nsi" start= auto
sc config "PcaSvc" start= demand
sc config "perceptionsimulation" start= demand
sc config "PerfHost" start= demand
sc config "PhoneSvc" start= demand
sc config "pla" start= demand
sc config "PlugPlay" start= demand
sc config "PolicyAgent" start= demand
sc config "Power" start= auto
sc config "PrintDeviceConfigurationService" start= demand
sc config "PrintScanBrokerService" start= demand
sc config "ProfSvc" start= auto
sc config "PushToInstall" start= demand
sc config "QWAVE" start= demand
sc config "RasAuto" start= demand
sc config "RasMan" start= demand
sc config "refsdedupsvc" start= demand
sc config "RemoteAccess" start= disabled
sc config "RemoteRegistry" start= disabled
sc config "RetailDemo" start= demand
sc config "RmSvc" start= demand
sc config "RpcEptMapper" start= auto
sc config "RpcLocator" start= disabled
sc config "RpcSs" start= auto
sc config "SamSs" start= auto
sc config "SCardSvr" start= demand
sc config "ScDeviceEnum" start= demand
sc config "Schedule" start= auto
sc config "SCPolicySvc" start= demand
sc config "SDRSVC" start= demand
sc config "seclogon" start= demand
sc config "SecurityHealthService" start= disabled
sc config "SEMgrSvc" start= demand
sc config "SENS" start= auto
sc config "SensorDataService" start= demand
sc config "SensorService" start= demand
sc config "SensrSvc" start= demand
sc config "SessionEnv" start= demand
sc config "SgrmBroker" start= disabled
sc config "SharedAccess" start= demand
sc config "ShellHWDetection" start= auto
sc config "shpamsvc" start= demand
sc config "smphost" start= demand
sc config "SmsRouter" start= demand
sc config "SNMPTrap" start= demand
sc config "Spooler" start= demand
sc config "sppsvc" start= auto
sc config "SSDPSRV" start= demand
sc config "ssh-agent" start= demand
sc config "SstpSvc" start= demand
sc config "StateRepository" start= auto
sc config "StiSvc" start= demand
sc config "StorSvc" start= auto
sc config "svsvc" start= demand
sc config "swprv" start= demand
sc config "SysMain" start= disabled
sc config "SystemEventsBroker" start= auto
sc config "TapiSrv" start= demand
sc config "TermService" start= demand
sc config "TextInputManagementService" start= auto
sc config "Themes" start= demand
sc config "TieringEngineService" start= demand
sc config "TimeBrokerSvc" start= demand
sc config "TokenBroker" start= demand
sc config "TrkWks" start= auto
sc config "TroubleshootingSvc" start= demand
sc config "TrustedInstaller" start= demand
sc config "tzautoupdate" start= demand
sc config "UmRdpService" start= demand
sc config "upnphost" start= demand
sc config "UserManager" start= auto
sc config "UsoSvc" start= demand
sc config "VaultSvc" start= demand
sc config "VBoxService" start= auto
sc config "vds" start= demand
sc config "vmicguestinterface" start= demand
sc config "vmicheartbeat" start= demand
sc config "vmickvpexchange" start= demand
sc config "vmicrdv" start= demand
sc config "vmicshutdown" start= demand
sc config "vmictimesync" start= demand
sc config "vmicvmsession" start= demand
sc config "vmicvss" start= demand
sc config "VSS" start= demand
sc config "W32Time" start= demand
sc config "WaaSMedicSvc" start= demand
sc config "WalletService" start= demand
sc config "WarpJITSvc" start= demand
sc config "wbengine" start= demand
sc config "WbioSrvc" start= demand
sc config "Wcmsvc" start= auto
sc config "wcncsvc" start= demand
sc config "WdiServiceHost" start= demand
sc config "WdiSystemHost" start= demand
sc config "WdNisSvc" start= disabled
sc config "WebClient" start= demand
sc config "webthreatdefsvc" start= disabled
sc config "Wecsvc" start= demand
sc config "WEPHOSTSVC" start= demand
sc config "wercplsupport" start= demand
sc config "WerSvc" start= disabled
sc config "WFDSConMgrSvc" start= demand
sc config "WiaRpc" start= demand
sc config "WinDefend" start= disabled
sc config "WinHttpAutoProxySvc" start= demand
sc config "Winmgmt" start= demand
sc config "WinRM" start= demand
sc config "wisvc" start= demand
sc config "WlanSvc" start= auto
sc config "wlidsvc" start= demand
sc config "wlpasvc" start= demand
sc config "WManSvc" start= demand
sc config "wmiApSrv" start= demand
sc config "WMPNetworkSvc" start= demand
sc config "workfolderssvc" start= demand
sc config "WpcMonSvc" start= demand
sc config "WPDBusEnum" start= demand
sc config "WpnService" start= auto
sc config "wscsvc" start= auto
sc config "WSearch" start= disabled
sc config "wuauserv" start= demand
sc config "WwanSvc" start= demand
sc config "XblAuthManager" start= demand
sc config "XblGameSave" start= demand
sc config "XboxGipSvc" start= demand
sc config "XboxNetApiSvc" start= demand
sc config "AarSvc_235fa" start= demand
sc config "BcastDVRUserService_235fa" start= demand
sc config "BluetoothUserService_235fa" start= demand
sc config "CaptureService_235fa" start= demand
sc config "cbdhsvc_235fa" start= auto
sc config "CDPUserSvc_235fa" start= auto
sc config "CloudBackupRestoreSvc_235fa" start= demand
sc config "ConsentUxUserSvc_235fa" start= demand
sc config "CredentialEnrollmentManagerUserSvc_235fa" start= demand
sc config "DeviceAssociationBrokerSvc_235fa" start= demand
sc config "DevicePickerUserSvc_235fa" start= demand
sc config "DevicesFlowUserSvc_235fa" start= demand
sc config "MessagingService_235fa" start= demand
sc config "NPSMSvc_235fa" start= demand
sc config "OneSyncSvc_235fa" start= demand
sc config "P9RdrService_235fa" start= demand
sc config "PenService_235fa" start= demand
sc config "PimIndexMaintenanceSvc_235fa" start= demand
sc config "PrintWorkflowUserSvc_235fa" start= demand
sc config "UdkUserSvc_235fa" start= demand
sc config "UnistoreSvc_235fa" start= demand
sc config "UserDataSvc_235fa" start= demand
sc config "webthreatdefusersvc_235fa" start= disabled
sc config "WpnUserService_235fa" start= auto
